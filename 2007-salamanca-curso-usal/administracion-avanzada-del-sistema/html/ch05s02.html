<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Grupos de volumen (volume groups)</title><meta name="generator" content="DocBook XSL Stylesheets V1.71.0"><link rel="start" href="index.html" title="Utilización y Administración avanzada de sistemas GNU/Linux y aplicaciones Software Libre para estudiantes universitarios"><link rel="up" href="ch05.html" title="Capítulo 5. Gestión de sistemas de ficheros mediante LVM"><link rel="prev" href="ch05.html" title="Capítulo 5. Gestión de sistemas de ficheros mediante LVM"><link rel="next" href="ch05s03.html" title="Particiones lógicas (logical volumes)"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Grupos de volumen (volume groups)</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch05.html">Anterior</a> </td><th width="60%" align="center">Capítulo 5. Gestión de sistemas de ficheros mediante <span class="emphasis"><em>LVM</em></span></th><td width="20%" align="right"> <a accesskey="n" href="ch05s03.html">Siguiente</a></td></tr></table><hr></div><div class="sect1" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2557427"></a>Grupos de volumen (volume groups)</h2></div></div></div><p>Los grupos de volumen son el equivalente a discos duros virtuales. Es decir un grupo de volumen estará formado por uno o varios dispositivos físicos o particiones.</p><p>Un grupo de volumen se crea de la siguiente forma:</p><pre class="screen">
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>vgcreate data_vg /dev/sda /dev/sdb /dev/sdc5</code></strong>
<code class="computeroutput">  Volume group "data_vg" successfully created</code>
<code class="prompt">[root@sal]# </code>
</pre><p>De esta forma habremos creado un grupo de volumen, disco virtual, que estará formado por los dispositivos físicos <span class="emphasis"><em>/dev/sda</em></span>, <span class="emphasis"><em>/dev/sdb</em></span> y la partición <span class="emphasis"><em>/dev/sdc5</em></span>.</p><p>Una vez hecho esto tendremos un directorio <code class="filename">/dev/data_vg/</code> en el cual se irán creando los ficheros de dispositivo que hacen referencia a las particiones lógicas que creemos dentro de este grupo de volumen.</p><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2557501"></a>Información y detección de grupos de volumen</h3></div></div></div><p>Podemos utilizar el comando <span><strong class="command">vgscan</strong></span> para encontrar grupos de volumen:</p><pre class="screen">
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>vgscan</code></strong>
<code class="computeroutput">  Reading all physical volumes. This may take a while...
  Found volume group "data_vg" using metadata type lvm2</code>
<code class="prompt">[root@sal]#</code>
</pre><p>También disponemos del comando <span><strong class="command">vgdisplay</strong></span> que nos ofrece más información sobre los grupos de volumen encontrados:</p><pre class="screen">
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>vgdisplay</code></strong>
<code class="computeroutput">  --- Volume group ---
  VG Name               data_vg
  System ID
  Format                lvm2
  Metadata Areas        1
  Metadata Sequence No  6
  VG Access             read/write
  VG Status             resizable
  MAX LV                0
  Cur LV                2
  Open LV               1
  Max PV                0
  Cur PV                1
  Act PV                1
  VG Size               50,00 GB
  PE Size               4,00 MB
  Total PE              12799
  Alloc PE / Size       10240 / 40,00 GB
  Free  PE / Size       2559 / 10,00 GB
  VG UUID               JJ3bIX-tqSM-r8Qd-nt0b-jWm9-7O4n-YiZYBK</code>
<code class="prompt">[root@sal]#</code>
</pre><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Sugerencia</h3><p>Podemos ver información detallada sobre el grupo de volumen utilizando el flag <span class="emphasis"><em>-v</em></span>.</p><pre class="screen">
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>vgdisplay -v</code></strong>
<code class="computeroutput">  --- Volume group ---
  VG Name               data_vg
  System ID
  Format                lvm2
  Metadata Areas        1
  Metadata Sequence No  6
  VG Access             read/write
  VG Status             resizable
  MAX LV                0
  Cur LV                2
  Open LV               1
  Max PV                0
  Cur PV                1
  Act PV                1
  VG Size               50,00 GB
  PE Size               4,00 MB
  Total PE              12799
  Alloc PE / Size       10240 / 40,00 GB
  Free  PE / Size       2559 / 10,00 GB
  VG UUID               JJ3bIX-tqSM-r8Qd-nt0b-jWm9-7O4n-YiZYBK

  --- Logical volume ---
  LV Name                /dev/data_vg/apache_lv
  VG Name                data_vg
  LV UUID                KCDc3t-jAHj-dNDK-I9qe-rF3B-oyya-Tg00JL
  LV Write Access        read/write
  LV Status              available
  # open                 1
  LV Size                20,00 GB
  Current LE             5120
  Segments               1
  Allocation             inherit
  Read ahead sectors     0
  Block device           253:0

  --- Logical volume ---
  LV Name                /dev/data_vg/mysql_lv
  VG Name                data_vg
  LV UUID                0m24gV-H9BC-MdbV-vSNZ-r57x-gx37-zUy22q
  LV Write Access        read/write
  LV Status              available
  # open                 0
  LV Size                20,00 GB
  Current LE             5120
  Segments               1
  Allocation             inherit
  Read ahead sectors     0
  Block device           253:1

  --- Physical volumes ---
  PV Name               /dev/sdd
  PV UUID               fKgSus-ts2y-vbR2-mTfy-YKPY-Aju1-C8SgV0
  PV Status             allocatable
  Total PE / Free PE    12799 / 2559</code>
<code class="prompt">[root@sal]#</code>
</pre></div><p>El comando <span><strong class="command">vgs</strong></span> también nos ofrece información:</p><pre class="screen">
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>vgs</code></strong>
<code class="computeroutput">  VG      #PV #LV #SN Attr   VSize  VFree
  data_vg   1   2   0 wz--n- 50,00G 10,00G</code>
<code class="prompt">[root@sal]# </code>
</pre></div><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2557729"></a>Ampliación de un grupo de volumen</h3></div></div></div><p>Cuando nos quedamos sin espacio en un grupo de volumen siempre podemos ampliarlo utilizando más dispositivos físicos o particiones. Para ello utilizaremos el comando <span><strong class="command">vgextend</strong></span>:</p><pre class="screen">
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>vgextend data_vg /dev/sdd</code></strong>
<code class="computeroutput"> Volume group "data_vg" successfully extended</code>
<code class="prompt">[root@sal]# </code>
</pre></div><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2557777"></a>Reducción de un grupo de volumen</h3></div></div></div><p>Podemos quitar dispositivos físicos de un grupo de volumen, siempre y cuando no esten en uso.</p><pre class="screen">
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>vgreduce data_vg /dev/sdd</code></strong>
<code class="computeroutput">  Removed "/dev/sdd" from volume group "data_vg"</code>
<code class="prompt">[root@sal]# </code>
</pre></div><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2557818"></a>Activación y desactivación de grupos de volumen</h3></div></div></div><p>Para poder utilizar los grupos de volumen es necesario que esten activos. Utilizaremos el comando <span><strong class="command">vgchange</strong></span> para activarlos y desactivarlos.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Sugerencia</h3><p>El comando <span><strong class="command">vgchange</strong></span> se utilizar para modificar los parámetros de los grupos de volumen.</p></div></div><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2557848"></a>Importación y exportación de grupos de volumen</h3></div></div></div><p>Hay ocasiones en las que es necesario mover discos entre diferentes máquinas. Por ejemplo imaginemos que tenemos varias instancias de BBDD en una máquina.</p><p>La configuración ideal para un entorno de este tipo es que cada instancia tenga sus datos en su propia partición y cada partición este en un grupo de volumen diferente. De esta forma si alguna de las instancias crece, en términos de potencia, siempre es posible cambiar alguna instacia a otra máquina.</p><p>En este caso tendremos que exportar el grupo de volumen que queremos mover a otra máquina y posteriormente importarlo.</p><p>Será necesario desactivar todas las particiones lógicas de ese grupo de volumen:</p><pre class="screen">
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>lvchange -a n /dev/data_vg/mysql_lv</code></strong>
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>vgexport data_vg</code></strong>
<code class="computeroutput"> Volume group "data_vg" successfully exported</code>
<code class="prompt">[root@sal]# </code>
</pre><p>Ahora podemos mover los dispositivos físicos que forman el grupo de volumen <span class="emphasis"><em>data_vg</em></span> a otra máquina e importarlos para poder utilizarlos:</p><pre class="screen">
<code class="prompt">[root@pal]# </code><strong class="userinput"><code>vgimport -a</code></strong>
<code class="computeroutput">  Volume group "data_vg" successfully imported</code>
<code class="prompt">[root@pal]# </code>
</pre></div><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2557957"></a>Eliminación de un grupo de volumen</h3></div></div></div><p>Para poder eliminar un grupo de volumen necesitaremos que no esté en uso ninguna de las particiones lógicas presentes y que este desactivado.</p><pre class="screen">
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>vgremove system_vg</code></strong>
<code class="computeroutput">  Volume group "system_vg" successfully removed</code>
<code class="prompt">[root@sal]# </code>
</pre></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch05.html">Anterior</a> </td><td width="20%" align="center"><a accesskey="u" href="ch05.html">Subir</a></td><td width="40%" align="right"> <a accesskey="n" href="ch05s03.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">Capítulo 5. Gestión de sistemas de ficheros mediante <span class="emphasis"><em>LVM</em></span> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> Particiones lógicas (logical volumes)</td></tr></table></div></body></html>
