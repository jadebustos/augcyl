<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Creación de sistemas de ficheros</title><meta name="generator" content="DocBook XSL Stylesheets V1.71.0"><link rel="start" href="index.html" title="Utilización y Administración avanzada de sistemas GNU/Linux y aplicaciones Software Libre para estudiantes universitarios"><link rel="up" href="ch04.html" title="Capítulo 4. Sistemas de Ficheros"><link rel="prev" href="ch04s08.html" title="Acceso a sistemas de ficheros"><link rel="next" href="ch04s10.html" title="Obtención de información sobre los sistemas de ficheros"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Creación de sistemas de ficheros</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch04s08.html">Anterior</a> </td><th width="60%" align="center">Capítulo 4. Sistemas de Ficheros</th><td width="20%" align="right"> <a accesskey="n" href="ch04s10.html">Siguiente</a></td></tr></table><hr></div><div class="sect1" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2549528"></a>Creación de sistemas de ficheros</h2></div></div></div><p>Para crear un sistema de ficheros lo primero que tenemos que hacer es crear una partición. Para ello podemos utilizar el comando <span><strong class="command">fdisk</strong></span> o <span><strong class="command">parted</strong></span>.</p><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2549551"></a>Los sistemas de ficheros <span class="emphasis"><em>ext2/ext3</em></span></h3></div></div></div><div class="sect3" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="id2549559"></a>El comando <span><strong class="command">mkfs</strong></span></h4></div></div></div><p>Este comando es utilizado para crear los sistemas de ficheros <span class="emphasis"><em>ext2</em></span> y <span class="emphasis"><em>ext3</em></span>, entre otros. Para más información mirar la página del manual.</p><p>Su sintaxis es muy sencilla:</p><pre class="screen">
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>mkfs -t ext2 /dev/fd0</code></strong>
<code class="computeroutput">mke2fs 1.23, 15-Aug-2001 for EXT2 FS 0.5b, 95/08/09
Filesystem label=
OS type: Linux
Block size=1024 (log=0)
Fragment size=1024 (log=0)
184 ubidesm 1440 blocks
72 blocks (5.00\%) reserved for the super user
First data block=1
1 block group
8192 blocks per group, 8192 fragments per group
184 inodes per group

Writing inode tables: done
Writing superblocks and filesystem accounting information: done

This filesystem will be automatically checked every 20 mounts or 
180 days, whichever comes first. Use tune2fs -c or -i to override.</code>
<code class="prompt">[root@sal]# </code>
</pre><p>La opción más interesante es <span class="emphasis"><em>-c</em></span> para que busque bloques en mal estado durante el formateo.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Sugerencia</h3><p>Para los tipos de sistemas de ficheros manejados por <span><strong class="command">mkfs</strong></span> existe el comando <span><strong class="command">mkfs.tipo</strong></span> donde <span class="emphasis"><em>tipo</em></span> es <span class="emphasis"><em>ext2</em></span>, ... y su uso es igual al de <span><strong class="command">mkfs</strong></span> sólo que no es necesario especificar el tipo de sistema de ficheros a crear.</p></div></div><div class="sect3" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="id2549665"></a>Conversión de sistemas de ficheros en <span class="emphasis"><em>ext2</em></span> a <span class="emphasis"><em>ext3</em></span></h4></div></div></div><p>En GNU/Linux los sistemas de ficheros más extendidos son <span class="emphasis"><em>ext2</em></span> y <span class="emphasis"><em>ext3</em></span>.</p><p>En realidad <span class="emphasis"><em>ext3</em></span> se puede considerar como <span class="emphasis"><em>ext2</em></span> con algunas mejoras. La más significativa de ellas es el <span class="emphasis"><em>journaling</em></span>.</p><p>Para convertir un sistema de ficheros <span class="emphasis"><em>ext2</em></span> a <span class="emphasis"><em>ext3</em></span>:</p><pre class="screen">
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>tune2fs -j /dev/sda1</code></strong>
</pre></div><div class="sect3" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="id2549731"></a>El superbloque y <span><strong class="command">tune2fs</strong></span></h4></div></div></div><p>El superbloque es bloque especial que contiene información sobre el sistema de ficheros. Para los sistemas de ficheros <span class="emphasis"><em>ext2/ext3</em></span> se puede ver o modificar con <span><strong class="command">tune2fs</strong></span>:</p><pre class="screen">
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>tune2fs -l /dev/hda2</code></strong>
<code class="computeroutput">tune2fs 1.40-WIP (02-Oct-2006)
Filesystem volume name:   &lt;none&gt;
Last mounted on:          &lt;not available&gt;
Filesystem UUID:          85314ef9-3429-42d2-b8bc-41b51b328ffa
Filesystem magic number:  0xEF53
Filesystem revision #:    1 (dynamic)
Filesystem features:      has_journal resize_inode dir_index filetype needs_recovery sparse_super large_file
Default mount options:    (none)
Filesystem state:         clean
Errors behavior:          Continue
Filesystem OS type:       Linux
Inode count:              24068096
Block count:              48104626
Reserved block count:     2405231
Free blocks:              43311411
Free inodes:              23958460
First block:              0
Block size:               4096
Fragment size:            4096
Reserved GDT blocks:      1012
Blocks per group:         32768
Fragments per group:      32768
Inodes per group:         16384
Inode blocks per group:   512
Filesystem created:       Sun Mar 25 06:10:23 2007
Last mount time:          Thu Apr  5 04:55:15 2007
Last write time:          Thu Apr  5 04:55:15 2007
Mount count:              9
Maximum mount count:      26
Last checked:             Sun Mar 25 06:10:23 2007
Check interval:           15552000 (6 months)
Next check after:         Fri Sep 21 06:10:23 2007
Reserved blocks uid:      0 (user root)
Reserved blocks gid:      0 (group root)
First inode:              11
Inode size:               128
Journal inode:            8
Default directory hash:   tea
Directory Hash Seed:      1ff4a0e4-fceb-45c1-93f8-5e9799e39496
Journal backup:           inode blocks</code>
<code class="prompt">[root@sal]# </code>
</pre><p>Las opciones más interesantes que podemos realizar:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="emphasis"><em>-c n</em></span> indicar después de cuantas operaciones de montaje se ha de realiza el chequeo del sistema de ficheros.</p></li><li><p><span class="emphasis"><em>-j </em></span> añadir la zona de <span class="emphasis"><em>journaling</em></span> a un sistema de ficheros <span class="emphasis"><em>ext2</em></span> para convertirlo en <span class="emphasis"><em>ext3</em></span>.</p></li><li><p><span class="emphasis"><em>-C n</em></span> cambiar el número de veces que el sistema ha sido montado. Si se estable a un valor mayor del indicado por <span class="emphasis"><em>-c n</em></span> en el siguiente montaje se chequeará de forma automática.</p></li><li><p><span class="emphasis"><em>-g gid</em></span> indicar el GID del grupo para el que se reservará espacio en el sistema de ficheros.</p></li><li><p><span class="emphasis"><em>-i n [d|w|m]</em></span> establece el periodo máximo de tiempo tras el cual se chequeará el sistema de ficheros. Independientemente de si se ha llegado al número máximo de operaciones de montaje.</p></li><li><p><span class="emphasis"><em>-L label</em></span> establece la etiqueta del sistema de ficheros.</p></li><li><p><span class="emphasis"><em>-m n</em></span> establece el tanto por ciento de bloques que se reservan.</p></li><li><p><span class="emphasis"><em>-r n</em></span> establece el número de bloques que se reservan.</p></li><li><p><span class="emphasis"><em>-u uid</em></span> establece el usuario para el que se reservará espacio.</p></li></ul></div></div><div class="sect3" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="id2549957"></a>El comando <span><strong class="command">mke2fs</strong></span></h4></div></div></div><p>La función de este comando es la de crear sistemas de ficheros <span class="emphasis"><em>ext2/ext3</em></span> y su uso es preferible al de <span><strong class="command">mkfs</strong></span>.</p><p>Se utiliza el fichero <code class="filename">/etc/mke2fs.conf</code> para determinar los valores por defecto cuando se crea un sistema de ficheros.</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Aviso</h3><p>No modificar <code class="filename">/etc/mke2fs.conf</code> a menos que se sepa lo que se está haciendo.</p></div></div><div class="sect3" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="id2550004"></a>Recuperación de sistemas de ficheros <span class="emphasis"><em>ext2/ext3</em></span></h4></div></div></div><p>Cuando nos encontremos errores en los sistemas de ficheros tendremos que chequearlos y para ello tendrán que estar desmontados.</p><p>El comando utilizado para chequear estos sistemas de ficheros es <span><strong class="command">e2fsck</strong></span>.</p><p>Algunas opciones interesantes:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="emphasis"><em>-b n</em></span> donde <span class="emphasis"><em>n</em></span> indica una copia del superbloque.</p><p>En los sistemas de ficheros <span class="emphasis"><em>ext2/ext3</em></span> se hacen copias de seguridad del superbloque repartidas por todo el sistema de ficheros (ver página del manual).</p></li><li><p><span class="emphasis"><em>-c</em></span> se utiliza el comando <span><strong class="command">badblocks</strong></span> para localizar bloques defectuosos y marcarlos como tales.</p></li><li><p><span class="emphasis"><em>-f</em></span> forzar el chequeo aunque el sistema de ficheros parezca limpio.</p></li><li><p><span class="emphasis"><em>-p</em></span> reparará de forma automática el sistema de ficheros si se puede hacer de forma segura.</p></li></ul></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Sugerencia</h3><p>Al igual que en el caso de <span><strong class="command">mke2fs</strong></span> existía <span><strong class="command">mkfs</strong></span> para chequear sistemas de ficheros también se puede utilizar el comando <span><strong class="command">fsck</strong></span>.</p></div></div><div class="sect3" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="id2550117"></a>El comando <span><strong class="command">badblocks</strong></span></h4></div></div></div><p>Este comando se utiliza para localizar bloques defectuosos en un sistema de ficheros.</p><p>La forma más sencilla de utilizarlo es:</p><pre class="screen">
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>badblocks /dev/sda1</code></strong>
</pre><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Sugerencia</h3><p>Podemos guardar la lista de bloques defectuosos en un fichero utilizando <span class="emphasis"><em>-o filename</em></span>.</p></div></div></div><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2550164"></a>El sistema de ficheros <span class="emphasis"><em>ReiserFS</em></span></h3></div></div></div><p><span class="emphasis"><em>ReiserFS</em></span> es otro sistema de ficheros <span class="emphasis"><em>transaccional</em></span>.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Sugerencia</h3><p>Será necesario instalar las utilidades de administración de dicho sistema de ficheros ya que no se suelen instalar por defecto.</p></div><p>Las principales utilidades de administración son:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="emphasis"><em>mkreiserfs</em></span> para crear sistemas de ficheros.</p></li><li><p><span class="emphasis"><em>reiserfsck</em></span> para chequear sistemas de ficheros.</p></li><li><p><span class="emphasis"><em>reiserfstune</em></span> para ajustar los parámetros del sistema de ficheros.</p></li><li><p><span class="emphasis"><em>resize_reiserfs</em></span> para redimensionar sistemas de ficheros.</p></li></ul></div></div><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2550236"></a>El sistema de ficheros <span class="emphasis"><em>JFS</em></span></h3></div></div></div><p>Este sistema de ficheros lo desarrolló <span class="emphasis"><em>IBM</em></span> y al igual que <span class="emphasis"><em>ext3</em></span> y <span class="emphasis"><em>ReiserFS</em></span> es un sistema de ficheros <span class="emphasis"><em>transaccional</em></span>.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Sugerencia</h3><p>Será necesario instalar las utilidades de administración de dicho sistema de ficheros ya que no se suelen instalar por defecto.</p></div><p>Las principales utilidades de administración son:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="emphasis"><em>jfs_mkfs</em></span> para crear sistemas de ficheros.</p></li><li><p><span class="emphasis"><em>jfs_fsck</em></span> para chequear sistemas de ficheros.</p></li><li><p><span class="emphasis"><em>jfs_tune</em></span> para ajustar los parámetros del sistema de ficheros.</p></li></ul></div></div><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2550306"></a>El sistema de ficheros <span class="emphasis"><em>XFS</em></span></h3></div></div></div><p>Este sistema de ficheros lo desarrolló <span class="emphasis"><em>SGI</em></span> y al igual que <span class="emphasis"><em>ext3</em></span> y <span class="emphasis"><em>ReiserFS</em></span> es un sistema de ficheros <span class="emphasis"><em>transaccional</em></span>.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Sugerencia</h3><p>Será necesario instalar las utilidades de administración de dicho sistema de ficheros ya que no se suelen instalar por defecto.</p></div><p>Las principales utilidades de administración son:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="emphasis"><em>mkfs.xfs</em></span> para crear sistemas de ficheros.</p></li><li><p><span class="emphasis"><em>xfs_check</em></span> para chequear sistemas de ficheros.</p></li><li><p><span class="emphasis"><em>xfs_repair</em></span> para reparar sistemas de ficheros.</p></li><li><p><span class="emphasis"><em>xfs_admin</em></span> para ajustar los parámetros del sistema de ficheros.</p></li><li><p><span class="emphasis"><em>xfs_freeze</em></span> congela el acceso al sistema de ficheros. Util para la creación de snapshots.</p></li><li><p><span class="emphasis"><em>xfs_growfs</em></span> redimensionar el sistema de ficheros.</p></li><li><p><span class="emphasis"><em>xfs_quota</em></span> manejo de cuotas.</p></li></ul></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch04s08.html">Anterior</a> </td><td width="20%" align="center"><a accesskey="u" href="ch04.html">Subir</a></td><td width="40%" align="right"> <a accesskey="n" href="ch04s10.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">Acceso a sistemas de ficheros </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> Obtención de información sobre los sistemas de ficheros</td></tr></table></div></body></html>
