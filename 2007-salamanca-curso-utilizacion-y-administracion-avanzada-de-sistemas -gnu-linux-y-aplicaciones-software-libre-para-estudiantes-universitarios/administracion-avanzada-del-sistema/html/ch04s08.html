<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Acceso a sistemas de ficheros</title><meta name="generator" content="DocBook XSL Stylesheets V1.71.0"><link rel="start" href="index.html" title="Utilización y Administración avanzada de sistemas GNU/Linux y aplicaciones Software Libre para estudiantes universitarios"><link rel="up" href="ch04.html" title="Capítulo 4. Sistemas de Ficheros"><link rel="prev" href="ch04s07.html" title="Tipos de dispositivos físicos"><link rel="next" href="ch04s09.html" title="Creación de sistemas de ficheros"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Acceso a sistemas de ficheros</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch04s07.html">Anterior</a> </td><th width="60%" align="center">Capítulo 4. Sistemas de Ficheros</th><td width="20%" align="right"> <a accesskey="n" href="ch04s09.html">Siguiente</a></td></tr></table><hr></div><div class="sect1" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2548672"></a>Acceso a sistemas de ficheros</h2></div></div></div><p>Para tener acceso a los diferentes sistemas de ficheros es necesario:</p><div class="itemizedlist"><ul type="disc"><li><p>Soporte en el núcleo para el tipo de dispositivo físico.</p></li><li><p>Soporte en el núcleo para el sistema de ficheros que hay en el dispositivo.</p></li><li><p>Montar el sistema de ficheros.</p></li></ul></div><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2548708"></a>El comando <span><strong class="command">mount</strong></span></h3></div></div></div><p>El comando <span><strong class="command">mount</strong></span> se utiliza para montar los sistemas de ficheros. Es decir para hacerlos accesibles desde el sistema.</p><p>En principio sólo es <span class="emphasis"><em>superusuario</em></span> o <span class="emphasis"><em>root</em></span> puede montar sistemas de ficheros en el sistema.</p><p>Para montar un sistema de ficheros:</p><pre class="screen">
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>mount -t ext3 /dev/sda5 /media/removible</code></strong>
</pre><div class="itemizedlist"><ul type="disc"><li><p><span class="emphasis"><em>-t ext3</em></span> es el tipo de sistema de ficheros que reside en el dispositivo.</p></li><li><p><span class="emphasis"><em>/dev/sda5</em></span> dispositivo que se quiere montar.</p></li><li><p><span class="emphasis"><em>/media/removible</em></span> punto de montaje en el que se montará.</p></li></ul></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Importante</h3><p>Es posible especificar opciones de montaje mediante el uso de <span class="emphasis"><em>-o</em></span> tales como sólo lectura, ...</p></div><p>Algunos tipos de sistemas de ficheros:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="emphasis"><em>ext2</em></span></p></li><li><p><span class="emphasis"><em>ext3</em></span></p></li><li><p><span class="emphasis"><em>iso9660</em></span></p></li><li><p><span class="emphasis"><em>reiserfs</em></span></p></li><li><p><span class="emphasis"><em>xfs</em></span></p></li><li><p><span class="emphasis"><em>jfs</em></span></p></li><li><p><span class="emphasis"><em>nfs</em></span></p></li><li><p><span class="emphasis"><em>cifs</em></span></p></li><li><p><span class="emphasis"><em>vfat</em></span></p></li><li><p><span class="emphasis"><em>msdos</em></span></p></li></ul></div><p>Existen algunas opciones interesantes a la hora de montar un sistema de ficheros. Algunas de ellas son comunes a todos ellos, mientras que otras dependen del sistema de ficheros:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="emphasis"><em>-o loop</em></span> permite el montar imágenes ISO a través del dispositivo de loopback:</p><pre class="screen">
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>mount -t iso9660 debian-sarge-dvd1.iso /media/iso -o loop</code></strong>
</pre></li><li><p><span class="emphasis"><em>-o rw</em></span> monta un sistema de ficheros en modo lectura/escritura.</p></li><li><p><span class="emphasis"><em>-o ro</em></span> monta un sistema de ficheros en modo sólo lectura.</p></li><li><p><span class="emphasis"><em>-o suid</em></span> permite la ejecución de SUIDs en el sistema de ficheros.</p></li><li><p><span class="emphasis"><em>-o nosuid</em></span> no permite la ejecución de SUIDs en el sistema de ficheros.</p></li><li><p><span class="emphasis"><em>-o exec</em></span> permite la ejecución de comandos en el sistema de ficheros.</p></li><li><p><span class="emphasis"><em>-o noexec</em></span> no permite la ejecución de comando en el sistema de ficheros.</p></li><li><p><span class="emphasis"><em>-o remount</em></span> permite montar un sistema de ficheros ya montado con otras opciones diferentes.</p></li><li><p><span class="emphasis"><em>-o owner</em></span> permite a un usuario sin privilegios montar un sistema de ficheros si es el propietario del dispositivo físico.</p></li><li><p><span class="emphasis"><em>-o nouser</em></span> no permite a los usuarios sin privilegios el montar sistemas de ficheros.</p></li><li><p><span class="emphasis"><em>-o user</em></span> permite a cualquier usuario montar y desmontar el sistema de ficheros.</p></li></ul></div></div><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2549028"></a>El comando <span><strong class="command">umount</strong></span></h3></div></div></div><p>El comando <span><strong class="command">umount</strong></span> se utiliza para desmontar sistemas de ficheros:</p><pre class="screen">
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>umount /media/iso</code></strong>
</pre><p>Desmontaría el sistema de ficheros montado en <code class="filename">/media/iso</code>.</p><p>Sólo el <span class="emphasis"><em>superusuario</em></span> o <span class="emphasis"><em>root</em></span> puede desmontar sistemas de ficheros.</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Importante</h3><p>Es posible permitir a usuarios sin privilegios montar sistemas de ficheros. En este caso el usuario que montó el sistema de ficheros podrá desmontarlo también.</p></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Aviso</h3><p>Para poder desmontar un sistema de archivos es necesario que ningún recurso del sistema este usando dicho dispositivo:</p><pre class="screen">
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>pwd</code></strong>
<code class="computeroutput">/media/iso</code>
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>umount /media/iso</code></strong>
<code class="computeroutput">umount: /media/iso: dispositivo ocupado</code>
<code class="prompt">[root@sal]# </code>
</pre></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Aviso</h3><p>Bajo ningún concepto se debe desconectar ningún dispositivo de almacenamiento del sistema sin desmontarlo previamente.</p><p>Cuando se hace una operación de escritura sobre un dispositivo, rara vez se hace directamente al dispositivo. Normalmente se escribe en una zona intermedia denominada <span class="emphasis"><em>buffer cache</em></span> y son los algoritmos de multitarea los que deciden cuando se va a ir escribiendo esa información al dispositivo.</p><p>Cuando se hace un <span><strong class="command">umount</strong></span> de un dispositivo se priorizan las escrituras pendientes sobre ese dispositivo (se hace un <span><strong class="command">sync</strong></span> sobre el dispositivo). Por este motivo si se desconecta un dispositivo del sistema sin haberlo desmontado previamente se perderan datos y se dice entonces que hay una inconsistencia en el sistema de archivos.</p><p>Con sistemas de archivos <span class="emphasis"><em>transaccionales</em></span> o de <span class="emphasis"><em>journaling</em></span> como <span class="emphasis"><em>ext3</em></span> o <span class="emphasis"><em>Reiser</em></span> es posible, en principio, recuperar esa información.</p></div></div><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2549203"></a>El fichero de configuración <code class="filename">/etc/fstab</code></h3></div></div></div><p>Este fichero tiene dos propositos:</p><div class="orderedlist"><ol type="1"><li><p>Especificar que sistemas de ficheros se montan en el arranque.</p></li><li><p>Indicar las opciones de montaje de los sistemas de ficheros.</p></li></ol></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Sugerencia</h3><p>Es posible montar un sistema de archivos especificando unicamente el punto de montaje si está en el fichero <code class="filename">/etc/fstab</code>. Se montará con las opciones especificadas en dicho fichero.</p></div><p>Un <code class="filename">/etc/fstab</code> típico:</p><pre class="programlisting">
LABEL=/     /             ext3          defaults       1 1
none        /proc         proc          defaults       0 0
/dev/hda5   swap          swap          defaults       0 0
/dev/hdc    /media/cdrom  iso9660       noauto,user,ro 0 0
/dev/fd0    /media/floppy auto          noauto,user    0 0
/dev/hda6   /media/vfat   vfat          noauto,user    0 0
/dev/sda1   /media/scsi   reiserfs      auto           0 0
</pre><p>Este fichero consta de seis columnas:</p><div class="orderedlist"><ol type="1"><li><p>La primera columna es el dispositivo físico o la etiqueta del sistema de ficheros.</p></li><li><p>La segunda columna es el punto de montaje.</p></li><li><p>La tercera columna es el sistema de ficheros que hay en el dispositivo.</p></li><li><p>La cuarta columna son las opciones de montaje.</p></li><li><p>La quinta columna es información para <span><strong class="command">dump</strong></span>. Si es un cero no es necesario hacer un dump del sistema de ficheros.</p><p>En caso de no encontrar nada se asume que es un cero.</p></li><li><p>La sexta columna indica a <span><strong class="command">fsck</strong></span> el orden en el que chequeará los sistemas de ficheros al arrancar.</p><p>Si hay un cero no chequeará el sistema de ficheros.</p></li></ol></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Sugerencia</h3><p>Si se utiliza <span class="emphasis"><em>user</em></span> como una de las opciones entonces se permite montar el sistema a cualquier usuario con las opciones indicadas en <code class="filename">/etc/fstab</code> pasandole a <span><strong class="command">mount</strong></span> el punto de montaje especificado en <code class="filename">/etc/fstab</code> unicamente.</p></div></div><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2549384"></a>El fichero <code class="filename">/proc/partitions</code></h3></div></div></div><p>Este fichero nos muestra las particiones que tenemos en el sistema:</p><pre class="screen">
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>cat /proc/partitions</code></strong>
<code class="computeroutput">
major minor  #blocks  name

   3     0  195360984 hda
   3     1  192418506 hda1
   3     2          1 hda2
   3     5    2939863 hda5
</code>
<code class="prompt">[root@sal]# </code>
</pre></div><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2549429"></a>El fichero <code class="filename">/proc/filesystems</code></h3></div></div></div><p>Este fichero nos muestra los filesystems con los que puede trabajar el núcleo en ese momento.</p><pre class="screen">
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>cat /proc/filesystems</code></strong>
<code class="computeroutput">
nodev   sysfs
nodev   rootfs
nodev   bdev
nodev   proc
nodev   securityfs
nodev   sockfs
nodev   pipefs
nodev   futexfs
nodev   tmpfs
nodev   inotifyfs
nodev   eventpollfs
nodev   devpts
        cramfs
nodev   ramfs
nodev   mqueue
nodev   usbfs
        ext3
</code>
<code class="prompt">[root@sal]# </code>
</pre></div><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2549478"></a>El fichero <code class="filename">/etc/mtab</code></h3></div></div></div><p>Este fichero nos muestra los filesystems que tenemos montados en el sistema y las opciones con las que fueron montados.</p><pre class="screen">
<code class="prompt">[root@sal]# </code><strong class="userinput"><code>cat /etc/mtab</code></strong>
<code class="computeroutput">/dev/hda1 / ext3 rw,errors=remount-ro 0 0
proc /proc proc rw,noexec,nosuid,nodev 0 0
/sys /sys sysfs rw,noexec,nosuid,nodev 0 0
udev /dev tmpfs rw,mode=0755 0 0
devshm /dev/shm tmpfs rw 0 0
devpts /dev/pts devpts rw,noexec,nosuid,gid=5,mode=620 0 0
usbfs /proc/bus/usb usbfs rw,noexec,nosuid,nodev 0 0</code>
<code class="prompt">[root@sal]# </code>
</pre></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch04s07.html">Anterior</a> </td><td width="20%" align="center"><a accesskey="u" href="ch04.html">Subir</a></td><td width="40%" align="right"> <a accesskey="n" href="ch04s09.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">Tipos de dispositivos físicos </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> Creación de sistemas de ficheros</td></tr></table></div></body></html>
