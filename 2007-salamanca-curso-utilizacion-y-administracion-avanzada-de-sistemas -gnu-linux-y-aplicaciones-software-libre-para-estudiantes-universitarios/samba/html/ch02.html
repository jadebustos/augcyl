<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Capítulo 2. Configuración de Samba</title><meta name="generator" content="DocBook XSL Stylesheets V1.71.0"><link rel="start" href="index.html" title="Utilización y Administración avanzada de sistemas GNU/Linux y aplicaciones Software Libre para estudiantes universitarios"><link rel="up" href="index.html" title="Utilización y Administración avanzada de sistemas GNU/Linux y aplicaciones Software Libre para estudiantes universitarios"><link rel="prev" href="ch01s06.html" title="Utilidad swat (Samba Web Administration Tool)"><link rel="next" href="ch02s02.html" title="Optimización de Samba"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Capítulo 2. Configuración de Samba</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch01s06.html">Anterior</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch02s02.html">Siguiente</a></td></tr></table><hr></div><div class="chapter" lang="es"><div class="titlepage"><div><div><h2 class="title"><a name="id2496600"></a>Capítulo 2. Configuración de Samba</h2></div></div></div><div class="toc"><p><b>Tabla de contenidos</b></p><dl><dt><span class="sect1"><a href="ch02.html#id2496606">El archivo <code class="filename">/etc/samba/smb.conf</code></a></span></dt><dd><dl><dt><span class="sect2"><a href="ch02.html#id2496693">Variables utilizables en <code class="filename">smb.conf</code></a></span></dt><dt><span class="sect2"><a href="ch02.html#id2545006">Sección [global]</a></span></dt><dt><span class="sect2"><a href="ch02.html#id2545233">Sección [homes]</a></span></dt></dl></dd><dt><span class="sect1"><a href="ch02s02.html">Optimización de Samba</a></span></dt><dt><span class="sect1"><a href="ch02s03.html">Compartiendo una unidad Windows con máquinas Linux</a></span></dt><dt><span class="sect1"><a href="ch02s04.html">Compartiendo una impresora de Windows con máquinas GNU/Linux</a></span></dt><dt><span class="sect1"><a href="ch02s05.html">Compartiendo una impresora de GNU/Linux con máquinas Windows</a></span></dt></dl></div><div class="sect1" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id2496606"></a>El archivo <code class="filename">/etc/samba/smb.conf</code></h2></div></div></div><p>El archivo <code class="filename">/etc/samba/smb.conf</code> es la columna vertebral del Servidor Samba. Este fichero determina qué recursos del sistema se quieren compartir y qué restricciones se desea aplicar sobre ellos. Este fichero se divide en secciones, las cuáles quedan delimitadas por el nombre de la sección, que debe estar entre corchetes. Su estructura es muy parecida a la de los ficheros .INI de MS Windows. Cada una de las secciones de este archivo describe un servicio determinado, a excepción de tres secciones que no describen ningún servicio y que son opcionales:</p><div class="orderedlist"><ol type="1"><li><p>Sección [global], en esta sección se definen los parámetros globales del servidor, es decir, que afectarán a todos los servicios del servidor.</p></li><li><p>Sección [homes], define el acceso a las cuentas de usuario, y el espacio en disco que tienen reservado en el servidor, generalmente en <code class="filename">/home/&lt;usuario&gt;</code>. Proporciona un método sencillo para que los usuarios que tienen una cuenta en el servidor Samba (Linux) accedan sin configurar apenas nada.</p></li><li><p>Sección [printers], que engloba a todas las impresoras, de forma que el servidor utiliza estos parámetros para las impresoras instaladas en el servidor (en <code class="filename">/etc/printcap</code>).</p></li></ol></div><p>Todos los recursos compartidos se definen en secciones separadas que comienzan con el nombre con el que el recurso compartido va a ser visible desde la red, encerrado entre corchetes (y que no puede tener más de 12 caracteres).</p><p>Dentro de la configuración es posible utilizar variables para expandirla y añadirle complejidad, con lo que se pueden definir comportamientos dependientes de la máquina del cliente, del usuario que accede al servicio, etc.</p><p>Después de hacer cualquier modificación, es importante ejecutar el programa <span><strong class="command">testparm</strong></span>, para probar que la configuración no tiene errores. Si este programa no da aviso de que hay problemas, devuelve la lista de servicios disponibles en el servidor.</p><p><span><strong class="command">smbstatus</strong></span> es un programa que devuelve la lista de todas las conexiones activas a Samba en el servidor local.</p><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2496693"></a>Variables utilizables en <code class="filename">smb.conf</code></h3></div></div></div><div class="orderedlist"><ol type="1"><li><p>%S, nombre del servicio actual, si lo hay.</p></li><li><p>%P, directorio raíz del servicio actual, si lo hay.</p></li><li><p>%u, nombre de usuario del servicio actual.</p></li><li><p>%g, grupo principal de %u.</p></li><li><p>%U, nombre de sesión del usuario (el que desea el cliente).</p></li><li><p>%G, grupo principal de %U.</p></li><li><p>%H, directorio raíz (home) del usuario %u.</p></li><li><p>%v, versión de Samba.</p></li><li><p>%h, nombre del servidor donde Samba está ejecutándose.</p></li><li><p>%m, nombre NetBios de la máquina cliente.</p></li><li><p>%L, nombre NetBios del servidor.</p></li><li><p>%M, nombre de Internet de la máquina cliente.</p></li><li><p>%d, número de proceso del servidor actual.</p></li><li><p>%a, arquitectura de la máquina cliente. Sólo reconoce algunas: Samba, WfWg, WinNT y Win95. Cualquier otra cosa la reconoce como <span class="emphasis"><em>UNKNOWN</em></span>.</p></li><li><p>%I, dirección IP de la máquina cliente.</p></li><li><p>%T, fecha y hora actuales.</p></li></ol></div></div><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2545006"></a>Sección [global]</h3></div></div></div><p>A continuación, se detallan los parámetros más importantes de la sección.</p><div class="orderedlist"><ol type="1"><li><p><span class="emphasis"><em>workgroup</em></span>, indica el nombre del grupo de trabajo (o dominio) en el que se quiere que funcione Samba. Ejemplo:</p><pre class="programlisting">
workgroup = NetSystems2000
</pre></li><li><p><span class="emphasis"><em>encrypt passwords = no</em></span>, evita que los passwords no se pasen como texto plano. Ponerlo a <span class="emphasis"><em>yes</em></span> si se tienen clientes W98 ó NT4/2000.</p></li><li><p><span class="emphasis"><em>server string</em></span>, es una cadena de caracteres que describe a la máquina, y que aparecerá como comentario en los clientes Windows. Ejemplo:</p><pre class="programlisting">
server string = NetSystems 2000 Internet Server ...
</pre></li><li><p><span class="emphasis"><em>log file</em></span>, permite que se cree un fichero de log por cada máquina que se conecta. Ejemplo:</p><pre class="programlisting">
log file = /var/log/samba.log.%m
</pre></li><li><p><span class="emphasis"><em>security</em></span>, indica el tipo de seguridad que empleará el servidor y puede tomar tres valores:</p><div class="orderedlist"><ol type="a"><li><p><span class="emphasis"><em>user</em></span>, que requiere que la máquina cliente se identifique con un nombre de usuario y una contraseña válida antes de conectarse al recurso compartido. Es el valor más adecuado.</p></li><li><p><span class="emphasis"><em>Share</em></span>, que sólo espera una contraseña válida para conectarse a un recurso.</p></li><li><p><span class="emphasis"><em>Server</em></span>, que es igual que el <span class="emphasis"><em>user</em></span> pero la autenticación del usuario se relega a otra máquina Windows NT.</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Importante</h3><p>En el caso de que se opte por este valor, habrá que añadir otra línea al <code class="filename">/etc/smb.conf</code>, que es:</p><pre class="programlisting">
password server = &lt;máquina&gt;
</pre><p>Ejemplo:</p><pre class="programlisting">
security = user
</pre></div></li></ol></div></li><li><p><span class="emphasis"><em>domain controller</em></span>, que permite especificar un controlador principal de dominio, en el caso de que lo haya. Ejemplo:</p><pre class="programlisting">
domain controller = mintserver
</pre></li><li><p><span class="emphasis"><em>netbios name</em></span>, es el nombre bajo el que el servidor Samba aparecerá en los clientes Windows. Ejemplo:</p><pre class="programlisting">
netbios name = SuSE10Linux
</pre></li><li><p><span class="emphasis"><em>wins support</em></span>, indica si se desea que el servidor Samba actúe como un servidor WINS.</p></li><li><p><span class="emphasis"><em>wins server = &lt;host&gt;</em></span>, indica qué máquina actúa como servidor WINS. Es decir, se supone que la máquina que ejecute Samba actuará como cliente WINS.</p></li></ol></div></div><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="id2545233"></a>Sección [homes]</h3></div></div></div><div class="orderedlist"><ol type="1"><li><p><span class="emphasis"><em>guest ok</em></span>, si un servicio tiene este parámetro habilitado, Samba no pedirá password para él. Ejemplo:</p><pre class="programlisting">
guest ok = yes
</pre></li><li><p><span class="emphasis"><em>valid users</em></span>, limita el acceso a un servicio a los usuarios que pertenezcan a la lista. Ejemplo:</p><pre class="programlisting">
valid users = juan,pepe,antonio
</pre></li><li><p><span class="emphasis"><em>hosts allow</em></span>, permite restringir las máquinas que podrán acceder a un determinado servicio. Ejemplo:</p><pre class="programlisting">
hosts allow = 192.168.30
</pre><p>permite que todas las máquinas de esa subred accedan mientras que <span class="emphasis"><em>hosts allow = 192.168.30.100</em></span> permite que sólo esa máquina acceda.</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Importante</h3><p>Puede aparecer también en un servicio.</p></div></li><li><p><span class="emphasis"><em>comment</em></span>, permite añadir un comentario al recurso que luego puede verse desde el Explorador de Windows.</p></li><li><p><span class="emphasis"><em>browseable</em></span>, define si un recurso es visto cuando se listen los recursos compartidos por el equipo.</p></li><li><p><span class="emphasis"><em>writable</em></span>, permite que los equipos que se conecten al recurso puedan escribir en él, crear carpetas, borrar, etc.</p></li><li><p><span class="emphasis"><em>path = &lt;ruta&gt;</em></span>, permite indicar el directorio físico real al cuál se accederá cuando se acceda al recurso compartido. Hay que tener cuidado con la máscara de permisos que tenga este directorio porque dependiendo de ella, dicho directorio pudiera no verse adecuadamente desde las máquinas Windows.</p></li><li><p><span class="emphasis"><em>printable</em></span>, permite imprimir en un recurso que sea una impresora.</p></li><li><p><span class="emphasis"><em>public</em></span>, define si un recurso es visible sólo para los usuarios autentificados (public = no) o para cualquiera que se conecte al equipo con Samba (public = yes).</p></li><li><p><span class="emphasis"><em>create mode</em></span>, permite especificar la máscara de permisos que tendrán los archivos que se vayan a crear en un determinado recurso.</p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Importante</h3><p><span class="emphasis"><em>directory mode</em></span> hace exactamente lo mismo, pero para directorios.</p></div></li></ol></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch01s06.html">Anterior</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch02s02.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">Utilidad swat (Samba Web Administration Tool) </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> Optimización de Samba</td></tr></table></div></body></html>
